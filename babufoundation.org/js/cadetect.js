function create_modal(e){var t='<style>.c-modal {z-index:1000;position: fixed;top: 0;left: 0;background: #00000070;width: 100%;height: 100%;display: flex;align-items:  center;justify-content: center;}.c-modal__container {background: #fff;padding: 2rem;width: 45.5rem;max-width: 100%;max-height: 100%;position: relative;}.c-modal__close {position: absolute;right: 0px;top: 0px;background: #990000;color: #fff;font-weight: 900;height: 2rem;width: 2rem;display: flex;align-items: center;justify-content: center;cursor: pointer;}.c-cadetect__button {margin: .5rem 1rem;font-size: 1.4rem;}</style><div class="c-modal"><div class="c-modal__container"><div class="c-modal__close">X</div><div class="c-modal__content">'+e+"</div></div></div>";$("body").append(t)}function createCookie(e,t,o){if(o){var a=new Date;a.setTime(a.getTime()+24*o*60*60*1e3);var i="; expires="+a.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"}function readCookie(e){for(var t=e+"=",o=document.cookie.split(";"),a=0;a<o.length;a++){for(var i=o[a];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function close_modal(e){e=$(e),e.animate({opacity:0},200),setTimeout(function(){e.remove()},200)}var usa_cookie=readCookie("wi_usa");null==usa_cookie||"false"==usa_cookie?$.ajax("//forms.compassion.com/api/iplocation/").done(function(e){if("CA"==e.countryCode){var t='<h3 style="text-align:center;">Our site has identified you as a visitor from Canada.</h3><p style="text-align:center;">Would you like to visit our Canadian site?</p><p style="text-align:center;"><a href="#" class="o-button c-cadetect__button" data-val="yes">Yes</a><a href="#" class="o-button o-button--blue c-cadetect__button" data-val="no">No</a></p><p style="text-align:right;"><input type="checkbox" name="cadetect-never" id="cadetect-never" value="never" /> <label for="cadetect-never">Do not ask again</label></p>';create_modal(t)}else"US"==e.countryCode&&createCookie("wi_usa","true",3500)}):"redirect_ca"==usa_cookie&&(window.location.href="//www.compassion.ca"),$(document).on("click",".c-cadetect__button",function(e){var t=$(this),o=$(this).parents(".c-modal");e.preventDefault();var a=t.attr("data-val"),i=o.find("#cadetect-never");"yes"==a?(i.is(":checked")?createCookie("wi_usa","redirect_ca",3500):createCookie("wi_usa","false",3500),window.location.href="//compassion.ca"):(close_modal(o),i.is(":checked")&&createCookie("wi_usa","no",3500))}),$(document).on("click",".js-cadetect-never",function(){createCookie("wi_usa","true",365e3)}),$(document).on("click",".c-modal__close",function(){modal=$(this).parents(".c-modal"),close_modal(modal)}),$(document).mouseup(function(e){var t=$(".c-modal");t.is(e.target)&&0===t.has(e.target).length&&close_modal(t)}),$(document).keyup(function(e){if(27==e.keyCode&&$(".c-modal").length>0){var t=$(".c-modal");close_modal(t)}});